<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RedNote ‚Äî –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    body { background: #f8f8f8; color: #111; line-height: 1.5; padding: 10px; max-width: 600px; margin: 0 auto; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 16px; background: white; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    header h1 { font-size: 24px; color: #e02020; }
    .create-post { background: white; padding: 16px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; margin-bottom: 10px; resize: vertical; min-height: 60px; }
    button { background: #e02020; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
    button:hover { background: #c01515; }
    .post { background: white; border-radius: 12px; padding: 16px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .post-header { display: flex; align-items: center; margin-bottom: 10px; }
    .post-avatar { width: 32px; height: 32px; border-radius: 50%; background: #eee; margin-right: 10px; }
    .post-author { font-weight: bold; }
    .post-time { color: #888; font-size: 13px; margin-left: 8px; }
    .post-content { margin: 10px 0; white-space: pre-wrap; }
    .post-actions { display: flex; gap: 16px; margin-top: 10px; }
    .like-btn, .comment-btn { background: none; border: none; color: #555; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 4px; }
    .like-btn.liked { color: #e02020; }
  </style>
</head>
<body>

  <header>
    <h1>üî¥ RedNote</h1>
    <div>–ì–æ—Å—Ç—å</div>
  </header>

  <main>
    <section class="create-post">
      <textarea id="postInput" placeholder="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ?"></textarea>
      <button id="postButton">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
    </section>

    <section id="feed">
      <!-- –ü–æ—Å—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
    </section>
  </main>

  <script>
    // –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage (—Ä–∞–±–æ—á–µ–µ –¥–∞–∂–µ –≤ file://)
    function getPosts() {
      try {
        return JSON.parse(localStorage.getItem('posts_v2') || '[]');
      } catch (e) {
        return [];
      }
    }

    function savePosts(posts) {
      try {
        localStorage.setItem('posts_v2', JSON.stringify(posts));
      } catch (e) {
        console.warn('localStorage –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –ø–æ—Å—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è');
      }
    }

    function timeAgo(timestamp) {
      const diffMs = Date.now() - new Date(timestamp);
      const diffMin = Math.floor(diffMs / 60000);
      if (diffMin < 1) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
      if (diffMin < 60) return `${diffMin} –º–∏–Ω –Ω–∞–∑–∞–¥`;
      const diffHr = Math.floor(diffMin / 60);
      if (diffHr < 24) return `${diffHr} —á –Ω–∞–∑–∞–¥`;
      return `${Math.floor(diffHr / 24)} –¥ –Ω–∞–∑–∞–¥`;
    }

    function render() {
      const feed = document.getElementById('feed');
      const posts = getPosts().reverse();
      feed.innerHTML = posts.map(p => `
        <article class="post">
          <div class="post-header">
            <div class="post-avatar"></div>
            <span class="post-author">–í—ã</span>
            <span class="post-time">${timeAgo(p.timestamp)}</span>
          </div>
          <div class="post-content">${p.text.replace(/\n/g, '<br>')}</div>
          <div class="post-actions">
            <button class="like-btn ${p.liked ? 'liked' : ''}" data-id="${p.id}">
              ‚ù§Ô∏è ${p.likes}
            </button>
            <button class="comment-btn">üí¨ 0</button>
          </div>
        </article>
      `).join('');

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      document.querySelectorAll('.like-btn').forEach(btn => {
        btn.onclick = () => {
          const id = +btn.dataset.id;
          const posts = getPosts();
          const post = posts.find(p => p.id === id);
          if (post) {
            post.liked = !post.liked;
            post.likes += post.liked ? 1 : -1;
            savePosts(posts);
            render();
          }
        };
      });
    }

    // –ü—É–±–ª–∏–∫–∞—Ü–∏—è
    document.getElementById('postButton').onclick = () => {
      const input = document.getElementById('postInput');
      const text = input.value.trim();
      if (!text) return;

      const posts = getPosts();
      posts.push({
        id: Date.now(),
        text,
        timestamp: new Date().toISOString(),
        likes: 0,
        liked: false
      });
      savePosts(posts);
      input.value = '';
      render();
    };

    // Enter ‚Üí –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
    document.getElementById('postInput').onkeydown = (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        document.getElementById('postButton').click();
      }
    };

    // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
    render();
  </script>

</body>
</html>
